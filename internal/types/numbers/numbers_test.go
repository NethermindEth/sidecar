package numbers

import (
	"fmt"
	"github.com/shopspring/decimal"
	"github.com/stretchr/testify/assert"
	"math"
	"math/big"
	"testing"
)

func roundToEven(f *big.Float) *big.Float {
	// Get the integer part of the float
	intPart, _ := f.Int(nil)

	// Create a big.Float from the integer part
	rounded := new(big.Float).SetInt(intPart)

	// Calculate the difference (fractional part)
	diff := new(big.Float).Sub(f, rounded)

	// Create a big.Float representing 0.5
	half := big.NewFloat(0.5)

	// Check if the fractional part is exactly 0.5
	if diff.Cmp(half) == 0 {
		// Check if the integer part is even
		intPartMod := new(big.Int).Mod(intPart, big.NewInt(2))
		if intPartMod.Cmp(big.NewInt(0)) != 0 {
			// If odd, round up
			rounded.Add(rounded, big.NewFloat(1))
		}
	} else if diff.Cmp(half) > 0 {
		// If the fractional part is greater than 0.5, round up
		rounded.Add(rounded, big.NewFloat(1))
	}

	return rounded
}

func Test_Numbers(t *testing.T) {
	if err := InitPython(); err != nil {
		t.Error(err)
	}
	defer FinalizePython()

	t.Run("Test that big.Int can produce negative numbers", func(t *testing.T) {
		startingNum := big.Int{}
		startingNum.SetString("10", 10)

		amountToSubtract := big.Int{}
		amountToSubtract.SetString("20", 10)

		assert.Equal(t, "-10", amountToSubtract.Sub(&startingNum, &amountToSubtract).String())
	})
	t.Run("Test that big.NewInt(257) can produce negative numbers", func(t *testing.T) {
		startingNum := big.NewInt(257)
		startingNum.SetString("10", 10)

		amountToSubtract := big.NewInt(257)
		amountToSubtract.SetString("20", 10)

		assert.Equal(t, "-10", amountToSubtract.Sub(startingNum, amountToSubtract).String())
	})
	t.Run("Test that Big257 can produce negative numbers", func(t *testing.T) {
		startingNum, success := NewBig257().SetString("10", 10)
		assert.True(t, success)

		amountToSubtract, success := NewBig257().SetString("20", 10)
		assert.True(t, success)

		assert.Equal(t, "-10", amountToSubtract.Sub(startingNum, amountToSubtract).String())
	})
	t.Run("Test a really big number", func(t *testing.T) {
		startingNum, success := NewBig257().SetString("13389173346000000000000000", 10)
		assert.True(t, success)

		assert.Equal(t, "13389173346000000000000000", startingNum.String())

		amountToSubtract, success := NewBig257().SetString("20", 10)
		assert.True(t, success)

		assert.Equal(t, "13389173345999999999999980", amountToSubtract.Sub(startingNum, amountToSubtract).String())
	})
	t.Run("Test floating point math to see if its correct", func(t *testing.T) {
		t.Skip("math/big is not accurate enough for this test")
		duration := float64(6048000)
		amountStr := "99999999999999999999999999999999999999"
		expectedRawTokensPerDay := "1428571428571428571428571428571428571"
		//expectedFloorValue := "1428571428571428571428571428571428571"
		//expectedRoundedValue := "1428571428571427000000000000000000000"
		// 1428571428571428500000000000000000000

		amount, _ := NewBig257().SetString(amountStr, 10)
		//amount, _, err := big.ParseFloat("99999999999999999999999999999999999999", 10, 38, big.ToPositiveInf)
		//assert.Nil(t, err)

		fmt.Printf("Amount: %+v\n", amount.String())

		amountFloat := big.NewFloat(0)
		amountFloat.SetInt(amount)
		amountFloat.SetMode(big.ToNearestEven)
		//amountFloat.SetPrec(256)

		divisor := big.NewFloat(float64(duration) / 86400)
		divisor.SetMode(big.ToNearestEven)
		fmt.Printf("Divisor: %+v\n", divisor.String())
		tokensPerDay := amountFloat.Quo(amountFloat, divisor)
		tokensPerDay = roundToEven(tokensPerDay)

		rawTokensPerDay := tokensPerDay.Text('f', 0)
		assert.Equal(t, expectedRawTokensPerDay, rawTokensPerDay)

		// We use floor to ensure we are always underesimating total tokens per day
		tokensPerDayFloored := NewBig257()
		tokensPerDayFloored, _ = tokensPerDay.Int(tokensPerDayFloored)

		precision := (math.Pow(10, 15) - float64(1)) / math.Pow(10, 15)

		// Round down to 15 sigfigs for double precision, ensuring know errouneous round up or down
		tokensPerDayDecimal := tokensPerDay.Mul(tokensPerDay, big.NewFloat(precision))

		fmt.Printf("tokensPerDayFloored: %s\n", tokensPerDayFloored.String())
		fmt.Printf("tokensPerDayDecimal: %s\n", tokensPerDayDecimal.String())

	})
	t.Run("Test floating point math to see if its correct with shopspring/decimal", func(t *testing.T) {
		duration := float64(6048000)
		amountStr := "99999999999999999999999999999999999999"
		expectedRawTokensPerDay := "1428571428571428571428571428571428571"
		expectedFloorValue := "1428571428571428571428571428571428571"
		// expectedRoundedValue := "1428571428571427000000000000000000000"
		// 1428571428571428500000000000000000000

		amount, err := decimal.NewFromString(amountStr)
		assert.Nil(t, err)

		fmt.Printf("Amount: %+v\n", amount.String())

		rawTokensPerDay := amount.Div(decimal.NewFromFloat(duration / 86400))
		fmt.Printf("Raw tokens per day: %+v\n", rawTokensPerDay.String())
		// rawTokensPerDayForRounding := amount.Div(decimal.NewFromFloat(duration / 86400))

		assert.Equal(t, expectedRawTokensPerDay, rawTokensPerDay.BigInt().String())

		tokensPerDayFloored := rawTokensPerDay.BigInt()

		assert.Equal(t, expectedFloorValue, tokensPerDayFloored.String())

		one := (decimal.NewFromInt(10).Pow(decimal.NewFromInt(15))).Sub(decimal.NewFromInt(1))
		two := decimal.NewFromInt(10).Pow(decimal.NewFromInt(15))

		fmt.Printf("one/two :%v\n", one.Div(two).String())
		assert.Equal(t, "0.999999999999999", one.Div(two).String())

	})

	t.Run("Test CalcRawTokensPerDay", func(t *testing.T) {
		amountStr := "99999999999999999999999999999999999999"
		duration := uint64(6048000)

		amount, err := CalcRawTokensPerDay(amountStr, duration)
		assert.Nil(t, err)
		assert.Equal(t, "1428571428571428571428571428571428571.4142857142857143", amount)
	})
	t.Run("Test PostNileTokensPerDay", func(t *testing.T) {
		duration := uint64(6048000)
		amountStr := "99999999999999999999999999999999999999"
		expectedFloorValue := "1428571428571428571428571428571428571"

		amount, err := CalcRawTokensPerDay(amountStr, duration)
		assert.Nil(t, err)

		amount, err = PostNileTokensPerDay(amount)
		assert.Nil(t, err)
		assert.Equal(t, expectedFloorValue, amount)
	})
	t.Run("Test PreNileTokensPerDay", func(t *testing.T) {
		duration := uint64(6048000)
		amountStr := "99999999999999999999999999999999999999"
		expectedRoundedValue := "1428571428571427000000000000000000000"

		amount, err := CalcRawTokensPerDay(amountStr, duration)
		assert.Nil(t, err)

		amount, err = PreNileTokensPerDay(amount)
		assert.Nil(t, err)
		assert.Equal(t, expectedRoundedValue, amount)
	})

	t.Run("Staker tokens", func(t *testing.T) {
		t.Run("Should correctly calculate the amazon token rewards for stakers", func(t *testing.T) {
			values := [][]string{
				[]string{"0.000009049993751000000000", "249999999999999740000", "2262498437750000"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804257000000"},
				[]string{"0.000004801343782000000000", "249999999999999740000", "1200335945500000"},
				[]string{"0.000010319286042000000000", "249999999999999740000", "2579821510500000"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804257000000"},
				[]string{"0.000000391928820000000000", "249999999999999740000", "97982205000000"},
				[]string{"0.000010926464639000000000", "249999999999999740000", "2731616159750000"},
				[]string{"0.000005872055410000000000", "249999999999999740000", "1468013852500000"},
				[]string{"0.000005842987054000000000", "249999999999999740000", "1460746763500000"},
				[]string{"0.000000391928820000000000", "249999999999999740000", "97982205000000"},
				[]string{"0.000008641233546000000000", "249999999999999740000", "2160308386500000"},
				[]string{"0.000008694529984000000000", "249999999999999740000", "2173632496000000"},
				[]string{"0.000003919288207000000000", "249999999999999740000", "979822051749999"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804257000000"},
				[]string{"0.000000391928820000000000", "249999999999999740000", "97982205000000"},
				[]string{"0.000004820724495000000000", "249999999999999740000", "1205181123750000"},
				[]string{"0.000006769304931000000000", "249999999999999740000", "1692326232750000"},
				[]string{"0.000000078385764000000000", "249999999999999740000", "19596441000000"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804257000000"},
				[]string{"0.000011067547868000000000", "249999999999999740000", "2766886967000000"},
				[]string{"0.000005684438299000000000", "249999999999999740000", "1421109574750000"},
				[]string{"0.000005308101027000000000", "249999999999999740000", "1327025256750000"},
				[]string{"0.000006052611919000000000", "249999999999999740000", "1513152979750000"},
				[]string{"0.000006897277137000000000", "249999999999999740000", "1724319284250000"},
				[]string{"0.000007524289114000000000", "249999999999999740000", "1881072278500000"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804257000000"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804257000000"},
				[]string{"0.000011068186249000000000", "249999999999999740000", "2767046562250000"},
				[]string{"0.000007086176189000000000", "249999999999999740000", "1771544047250000"},
				[]string{"0.000003919288207000000000", "249999999999999740000", "979822051749999"},
				[]string{"0.000011066475358000000000", "249999999999999740000", "2766618839500000"},
				[]string{"0.000004445997620000000000", "249999999999999740000", "1111499405000000"},
				[]string{"0.000005026149490000000000", "249999999999999740000", "1256537372500000"},
				[]string{"0.000005245237427000000000", "249999999999999740000", "1311309356750000"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804257000000"},
				[]string{"0.000005906556295000000000", "249999999999999740000", "1476639073750000"},
				[]string{"0.000002477475271000000000", "249999999999999740000", "619368817749999"},
				[]string{"0.000009406291697000000000", "249999999999999740000", "2351572924250000"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804257000000"},
				[]string{"0.00015529746717900000", "249999999999999740000", "38824366794750000"},
				[]string{"0.000005319693767000000000", "249999999999999740000", "1329923441750000"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804257000000"},
				[]string{"0.000004684377878000000000", "249999999999999740000", "1171094469500000"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804257000000"},
				[]string{"0.000008658154920000000000", "249999999999999740000", "2164538730000000"},
				[]string{"0.000008377062090000000000", "249999999999999740000", "2094265522500000"},
				[]string{"0.000005795889243000000000", "249999999999999740000", "1448972310750000"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804257000000"},
				[]string{"0.000005615005446000000000", "249999999999999740000", "1403751361500000"},
				[]string{"0.000003919288207000000000", "249999999999999740000", "979822051749999"},
			}

			for i, value := range values {
				stakerProportion := value[0]
				tokensPerDay := value[1]
				expectedValue := value[2]
				result, err := CalculateAmazonStakerTokenRewards(stakerProportion, tokensPerDay)
				assert.Nil(t, err)

				assert.Equal(t, expectedValue, result, fmt.Sprintf("row %d: '%s' - '%s' - '%s'", i, stakerProportion, tokensPerDay, expectedValue))
			}

		})
		t.Run("Should correctly calculate the nile token rewards for stakers", func(t *testing.T) {
			values := [][]string{
				[]string{"0.000009049993751000000000", "249999999999999740000", "2262498437749998"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804256999999"},
				[]string{"0.000004801343782000000000", "249999999999999740000", "1200335945499999"},
				[]string{"0.000010319286042000000000", "249999999999999740000", "2579821510499997"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804256999999"},
				[]string{"0.000000391928820000000000", "249999999999999740000", "97982205000000"},
				[]string{"0.000010926464639000000000", "249999999999999740000", "2731616159749997"},
				[]string{"0.000005872055410000000000", "249999999999999740000", "1468013852499999"},
				[]string{"0.000005842987054000000000", "249999999999999740000", "1460746763499999"},
				[]string{"0.000000391928820000000000", "249999999999999740000", "97982205000000"},
				[]string{"0.000008641233546000000000", "249999999999999740000", "2160308386499998"},
				[]string{"0.000008694529984000000000", "249999999999999740000", "2173632495999998"},
				[]string{"0.000003919288207000000000", "249999999999999740000", "979822051749999"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804256999999"},
				[]string{"0.000000391928820000000000", "249999999999999740000", "97982205000000"},
				[]string{"0.000004820724495000000000", "249999999999999740000", "1205181123749999"},
				[]string{"0.000006769304931000000000", "249999999999999740000", "1692326232749998"},
				[]string{"0.000000078385764000000000", "249999999999999740000", "19596441000000"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804256999999"},
				[]string{"0.000011067547868000000000", "249999999999999740000", "2766886966999997"},
				[]string{"0.000005684438299000000000", "249999999999999740000", "1421109574749999"},
				[]string{"0.000005308101027000000000", "249999999999999740000", "1327025256749999"},
				[]string{"0.000006052611919000000000", "249999999999999740000", "1513152979749999"},
				[]string{"0.000006897277137000000000", "249999999999999740000", "1724319284249998"},
				[]string{"0.000007524289114000000000", "249999999999999740000", "1881072278499998"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804256999999"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804256999999"},
				[]string{"0.000011068186249000000000", "249999999999999740000", "2767046562249997"},
				[]string{"0.000007086176189000000000", "249999999999999740000", "1771544047249998"},
				[]string{"0.000003919288207000000000", "249999999999999740000", "979822051749999"},
				[]string{"0.000011066475358000000000", "249999999999999740000", "2766618839499997"},
				[]string{"0.000004445997620000000000", "249999999999999740000", "1111499404999999"},
				[]string{"0.000005026149490000000000", "249999999999999740000", "1256537372499999"},
				[]string{"0.000005245237427000000000", "249999999999999740000", "1311309356749999"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804256999999"},
				[]string{"0.000005906556295000000000", "249999999999999740000", "1476639073749999"},
				[]string{"0.000002477475271000000000", "249999999999999740000", "619368817749999"},
				[]string{"0.000009406291697000000000", "249999999999999740000", "2351572924249998"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804256999999"},
				[]string{"0.00015529746717900000", "249999999999999740000", "38824366794749960"},
				[]string{"0.000005319693767000000000", "249999999999999740000", "1329923441749999"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804256999999"},
				[]string{"0.000004684377878000000000", "249999999999999740000", "1171094469499999"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804256999999"},
				[]string{"0.000008658154920000000000", "249999999999999740000", "2164538729999998"},
				[]string{"0.000008377062090000000000", "249999999999999740000", "2094265522499998"},
				[]string{"0.000005795889243000000000", "249999999999999740000", "1448972310749999"},
				[]string{"0.000004311217028000000000", "249999999999999740000", "1077804256999999"},
				[]string{"0.000005615005446000000000", "249999999999999740000", "1403751361499999"},
				[]string{"0.000003919288207000000000", "249999999999999740000", "979822051749999"},
			}

			for i, value := range values {
				stakerProportion := value[0]
				tokensPerDay := value[1]
				expectedValue := value[2]
				result, err := CalculateNileStakerTokenRewards(stakerProportion, tokensPerDay)
				assert.Nil(t, err)

				assert.Equal(t, expectedValue, result, fmt.Sprintf("row %d: '%s' - '%s' - '%s'", i, stakerProportion, tokensPerDay, expectedValue))
			}
		})
		t.Run("Should correctly calculate the post-nile token rewards for stakers", func(t *testing.T) {
			values := [][]string{
				[]string{"0.000009049993751", "249999999999999740000", "2262498437749997", "2262498437749997.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004801343782", "249999999999999740000", "1200335945499998", "1200335945499998.8"},
				[]string{"0.000010319286042", "249999999999999740000", "2579821510499997", "2579821510499997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.00000039192882", "249999999999999740000", "97982204999999", "97982204999999.89"},
				[]string{"0.000010926464639", "249999999999999740000", "2731616159749997", "2731616159749997"},
				[]string{"0.00000587205541", "249999999999999740000", "1468013852499998", "1468013852499998.5"},
				[]string{"0.000005842987054", "249999999999999740000", "1460746763499998", "1460746763499998.5"},
				[]string{"0.00000039192882", "249999999999999740000", "97982204999999", "97982204999999.89"},
				[]string{"0.000008641233546", "249999999999999740000", "2160308386499998", "2160308386499998"},
				[]string{"0.000008694529984", "249999999999999740000", "2173632495999997", "2173632495999997.8"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.00000039192882", "249999999999999740000", "97982204999999", "97982204999999.89"},
				[]string{"0.000004820724495", "249999999999999740000", "1205181123749998", "1205181123749998.8"},
				[]string{"0.000006769304931", "249999999999999740000", "1692326232749998", "1692326232749998.2"},
				[]string{"0.000000078385764", "249999999999999740000", "19596440999999", "19596440999999.98"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011067547868", "249999999999999740000", "2766886966999997", "2766886966999997"},
				[]string{"0.000005684438299", "249999999999999740000", "1421109574749998", "1421109574749998.5"},
				[]string{"0.000005308101027", "249999999999999740000", "1327025256749998", "1327025256749998.5"},
				[]string{"0.000006052611919", "249999999999999740000", "1513152979749998", "1513152979749998.5"},
				[]string{"0.000006897277137", "249999999999999740000", "1724319284249998", "1724319284249998.2"},
				[]string{"0.000007524289114", "249999999999999740000", "1881072278499998", "1881072278499998"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011068186249", "249999999999999740000", "2767046562249997", "2767046562249997"},
				[]string{"0.000007086176189", "249999999999999740000", "1771544047249998", "1771544047249998.2"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000011066475358", "249999999999999740000", "2766618839499997", "2766618839499997"},
				[]string{"0.00000444599762", "249999999999999740000", "1111499404999998", "1111499404999998.8"},
				[]string{"0.00000502614949", "249999999999999740000", "1256537372499998", "1256537372499998.8"},
				[]string{"0.000005245237427", "249999999999999740000", "1311309356749998", "1311309356749998.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005906556295", "249999999999999740000", "1476639073749998", "1476639073749998.5"},
				[]string{"0.000002477475271", "249999999999999740000", "619368817749999", "619368817749999.4"},
				[]string{"0.000009406291697", "249999999999999740000", "2351572924249997", "2351572924249997.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000155297467179", "249999999999999740000", "38824366794749960", "38824366794749960"},
				[]string{"0.000005319693767", "249999999999999740000", "1329923441749998", "1329923441749998.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004684377878", "249999999999999740000", "1171094469499998", "1171094469499998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.00000865815492", "249999999999999740000", "2164538729999997", "2164538729999997.5"},
				[]string{"0.00000837706209", "249999999999999740000", "2094265522499997", "2094265522499997.8"},
				[]string{"0.000005795889243", "249999999999999740000", "1448972310749998", "1448972310749998.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005615005446", "249999999999999740000", "1403751361499998", "1403751361499998.5"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000004343211879", "249999999999999740000", "1085802969749998", "1085802969749998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004497233707", "249999999999999740000", "1124308426749998", "1124308426749998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.00000473160595", "249999999999999740000", "1182901487499998", "1182901487499998.8"},
				[]string{"0.000005489864048", "249999999999999740000", "1372466011999998", "1372466011999998.5"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000004481283758", "249999999999999740000", "1120320939499998", "1120320939499998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011254974313", "249999999999999740000", "2813743578249997", "2813743578249997"},
				[]string{"0.000007988838178", "249999999999999740000", "1997209544499998", "1997209544499998"},
				[]string{"0.000001371750872", "249999999999999740000", "342937717999999", "342937717999999.6"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000010018074899", "249999999999999740000", "2504518724749997", "2504518724749997.5"},
				[]string{"0.000001959644103", "249999999999999740000", "489911025749999", "489911025749999.44"},
				[]string{"0.000004677431991", "249999999999999740000", "1169357997749998", "1169357997749998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005052634215", "249999999999999740000", "1263158553749998", "1263158553749998.8"},
				[]string{"0.000004378562562", "249999999999999740000", "1094640640499998", "1094640640499998.9"},
				[]string{"0.000005136263081", "249999999999999740000", "1284065770249998", "1284065770249998.5"},
				[]string{"0.000006086614747", "249999999999999740000", "1521653686749998", "1521653686749998.2"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.00000678008036", "249999999999999740000", "1695020089999998", "1695020089999998"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004358362661", "249999999999999740000", "1089590665249998", "1089590665249998.8"},
				[]string{"0.000017333414377", "249999999999999740000", "4333353594249995", "4333353594249995.5"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000011067443446", "249999999999999740000", "2766860861499997", "2766860861499997"},
				[]string{"0.000014949678468", "249999999999999740000", "3737419616999996", "3737419616999996"},
				[]string{"0.000006730676146", "249999999999999740000", "1682669036499998", "1682669036499998.2"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.002874063817455", "249999999999999740000", "718515954363749250", "718515954363749250"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000013402738201", "249999999999999740000", "3350684550249996", "3350684550249996.5"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011066683042", "249999999999999740000", "2766670760499997", "2766670760499997"},
				[]string{"0.000004559116932", "249999999999999740000", "1139779232999998", "1139779232999998.8"},
				[]string{"0.000005178812729", "249999999999999740000", "1294703182249998", "1294703182249998.8"},
				[]string{"0.00000560777371", "249999999999999740000", "1401943427499998", "1401943427499998.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000034647768302", "249999999999999740000", "8661942075499991", "8661942075499991"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000000039192882", "249999999999999740000", "9798220499999", "9798220499999.99"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005318465383", "249999999999999740000", "1329616345749998", "1329616345749998.8"},
				[]string{"0.000009142886932", "249999999999999740000", "2285721732999997", "2285721732999997.5"},
				[]string{"0.000000001763323", "249999999999999740000", "440830749999", "440830749999.9995"},
				[]string{"0.000005239479729", "249999999999999740000", "1309869932249998", "1309869932249998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011068572525", "249999999999999740000", "2767143131249997", "2767143131249997"},
				[]string{"0.000004349799583", "249999999999999740000", "1087449895749998", "1087449895749998.9"},
				[]string{"0.000005762329847", "249999999999999740000", "1440582461749998", "1440582461749998.5"},
				[]string{"0.000005750387614", "249999999999999740000", "1437596903499998", "1437596903499998.5"},
				[]string{"0.000014959041874", "249999999999999740000", "3739760468499996", "3739760468499996"},
				[]string{"0.000004915721371", "249999999999999740000", "1228930342749998", "1228930342749998.8"},
				[]string{"0.000006674009818", "249999999999999740000", "1668502454499998", "1668502454499998.2"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000081602837875", "249999999999999740000", "20400709468749976", "20400709468749976"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000006004611299", "249999999999999740000", "1501152824749998", "1501152824749998.2"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000006355155937", "249999999999999740000", "1588788984249998", "1588788984249998.5"},
				[]string{"0.00000039192882", "249999999999999740000", "97982204999999", "97982204999999.89"},
				[]string{"0.000011067820412", "249999999999999740000", "2766955102999997", "2766955102999997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004855108806", "249999999999999740000", "1213777201499998", "1213777201499998.8"},
				[]string{"0.000011066088948", "249999999999999740000", "2766522236999997", "2766522236999997.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000006074896721", "249999999999999740000", "1518724180249998", "1518724180249998.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000000408162188", "249999999999999740000", "102040546999999", "102040546999999.89"},
				[]string{"0.000006086654586", "249999999999999740000", "1521663646499998", "1521663646499998.5"},
				[]string{"0.000011067533248", "249999999999999740000", "2766883311999997", "2766883311999997.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004959654658", "249999999999999740000", "1239913664499998", "1239913664499998.8"},
				[]string{"0.000004334593317", "249999999999999740000", "1083648329249998", "1083648329249998.9"},
				[]string{"0.000011066270658", "249999999999999740000", "2766567664499997", "2766567664499997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000000485991737", "249999999999999740000", "121497934249999", "121497934249999.86"},
				[]string{"0.000005957318075", "249999999999999740000", "1489329518749998", "1489329518749998.5"},
				[]string{"0.000002821887509", "249999999999999740000", "705471877249999", "705471877249999.2"},
				[]string{"0.000005460297788", "249999999999999740000", "1365074446999998", "1365074446999998.5"},
				[]string{"0.000000593038012", "249999999999999740000", "148259502999999", "148259502999999.84"},
				[]string{"0.00000048232807", "249999999999999740000", "120582017499999", "120582017499999.88"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000013835090761", "249999999999999740000", "3458772690249996", "3458772690249996.5"},
				[]string{"0.000004387386402", "249999999999999740000", "1096846600499998", "1096846600499998.9"},
				[]string{"0.00001056846525", "249999999999999740000", "2642116312499997", "2642116312499997.5"},
				[]string{"0.000004744198683", "249999999999999740000", "1186049670749998", "1186049670749998.8"},
				[]string{"0.000013517447109", "249999999999999740000", "3379361777249996", "3379361777249996.5"},
				[]string{"0.000004292111888", "249999999999999740000", "1073027971999998", "1073027971999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000008820012468", "249999999999999740000", "2205003116999997", "2205003116999997.5"},
				[]string{"0.000005601905333", "249999999999999740000", "1400476333249998", "1400476333249998.5"},
				[]string{"0.000005339016974", "249999999999999740000", "1334754243499998", "1334754243499998.5"},
				[]string{"0.000300001044541", "249999999999999740000", "75000261135249920", "75000261135249920"},
				[]string{"0.000011067668642", "249999999999999740000", "2766917160499997", "2766917160499997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000016325425419", "249999999999999740000", "4081356354749995", "4081356354749995.5"},
				[]string{"0.000000460259862", "249999999999999740000", "115064965499999", "115064965499999.88"},
				[]string{"0.000000563455944", "249999999999999740000", "140863985999999", "140863985999999.88"},
				[]string{"0.00000568617956", "249999999999999740000", "1421544889999998", "1421544889999998.5"},
				[]string{"0.000004999005702", "249999999999999740000", "1249751425499998", "1249751425499998.5"},
				[]string{"0.00000609084659", "249999999999999740000", "1522711647499998", "1522711647499998.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011067715964", "249999999999999740000", "2766928990999997", "2766928990999997"},
				[]string{"0.000005004891542", "249999999999999740000", "1251222885499998", "1251222885499998.8"},
				[]string{"0.000007218680732", "249999999999999740000", "1804670182999998", "1804670182999998"},
				[]string{"0.000005144299747", "249999999999999740000", "1286074936749998", "1286074936749998.8"},
				[]string{"0.00008989838143", "249999999999999740000", "22474595357499976", "22474595357499976"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011067089214", "249999999999999740000", "2766772303499997", "2766772303499997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000006545911248", "249999999999999740000", "1636477811999998", "1636477811999998.2"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011067039047", "249999999999999740000", "2766759761749997", "2766759761749997.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000009471564941", "249999999999999740000", "2367891235249997", "2367891235249997.5"},
				[]string{"0.000008445422705", "249999999999999740000", "2111355676249997", "2111355676249997.8"},
				[]string{"0.00000039192882", "249999999999999740000", "97982204999999", "97982204999999.89"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005340280631", "249999999999999740000", "1335070157749998", "1335070157749998.5"},
				[]string{"0.00000435529761", "249999999999999740000", "1088824402499998", "1088824402499998.9"},
				[]string{"0.000006367452314", "249999999999999740000", "1591863078499998", "1591863078499998.2"},
				[]string{"0.000004372836209", "249999999999999740000", "1093209052249998", "1093209052249998.9"},
				[]string{"0.000004926901446", "249999999999999740000", "1231725361499998", "1231725361499998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004755398978", "249999999999999740000", "1188849744499998", "1188849744499998.8"},
				[]string{"0.000005303897879", "249999999999999740000", "1325974469749998", "1325974469749998.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004682911838", "249999999999999740000", "1170727959499998", "1170727959499998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011066751231", "249999999999999740000", "2766687807749997", "2766687807749997"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004781531613", "249999999999999740000", "1195382903249998", "1195382903249998.8"},
				[]string{"0.000000526960156", "249999999999999740000", "131740038999999", "131740038999999.86"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000006337819945", "249999999999999740000", "1584454986249998", "1584454986249998.5"},
				[]string{"0.00000598555262", "249999999999999740000", "1496388154999998", "1496388154999998.5"},
				[]string{"0.000011133520684", "249999999999999740000", "2783380170999997", "2783380170999997"},
				[]string{"0.000011067413867", "249999999999999740000", "2766853466749997", "2766853466749997"},
				[]string{"0.00000039192882", "249999999999999740000", "97982204999999", "97982204999999.89"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005037750053", "249999999999999740000", "1259437513249998", "1259437513249998.8"},
				[]string{"0.000010238640377", "249999999999999740000", "2559660094249997", "2559660094249997.5"},
				[]string{"0.00000039192882", "249999999999999740000", "97982204999999", "97982204999999.89"},
				[]string{"0.00000039192882", "249999999999999740000", "97982204999999", "97982204999999.89"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000031315112777", "249999999999999740000", "7828778194249992", "7828778194249992"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004552220781", "249999999999999740000", "1138055195249998", "1138055195249998.8"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000004771744448", "249999999999999740000", "1192936111999998", "1192936111999998.8"},
				[]string{"0.000004470418106", "249999999999999740000", "1117604526499998", "1117604526499998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000001567715282", "249999999999999740000", "391928820499999", "391928820499999.56"},
				[]string{"0.000006685375775", "249999999999999740000", "1671343943749998", "1671343943749998.2"},
				[]string{"0.00000495047661", "249999999999999740000", "1237619152499998", "1237619152499998.8"},
				[]string{"0.000005844909181", "249999999999999740000", "1461227295249998", "1461227295249998.5"},
				[]string{"0.000000002145689", "249999999999999740000", "536422249999", "536422249999.99945"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000002987135399", "249999999999999740000", "746783849749999", "746783849749999.2"},
				[]string{"0.000034747556263", "249999999999999740000", "8686889065749991", "8686889065749991"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000014311629335", "249999999999999740000", "3577907333749996", "3577907333749996.5"},
				[]string{"0.000000039192882", "249999999999999740000", "9798220499999", "9798220499999.99"},
				[]string{"0.000011066754626", "249999999999999740000", "2766688656499997", "2766688656499997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004761442856", "249999999999999740000", "1190360713999998", "1190360713999998.8"},
				[]string{"0.000005488681729", "249999999999999740000", "1372170432249998", "1372170432249998.5"},
				[]string{"0.000004720390951", "249999999999999740000", "1180097737749998", "1180097737749998.8"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004926662957", "249999999999999740000", "1231665739249998", "1231665739249998.8"},
				[]string{"0.000005003715806", "249999999999999740000", "1250928951499998", "1250928951499998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004489784075", "249999999999999740000", "1122446018749998", "1122446018749998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000013860083391", "249999999999999740000", "3465020847749996", "3465020847749996.5"},
				[]string{"0.000001990011373", "249999999999999740000", "497502843249999", "497502843249999.5"},
				[]string{"0.00001106677849", "249999999999999740000", "2766694622499997", "2766694622499997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000000039196801", "249999999999999740000", "9799200249999", "9799200249999.99"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000013572735485", "249999999999999740000", "3393183871249996", "3393183871249996.5"},
				[]string{"0.000004899110259", "249999999999999740000", "1224777564749998", "1224777564749998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011067136903", "249999999999999740000", "2766784225749997", "2766784225749997"},
				[]string{"0.000004336354665", "249999999999999740000", "1084088666249998", "1084088666249998.9"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000000482687193", "249999999999999740000", "120671798249999", "120671798249999.86"},
				[]string{"0.00000039192882", "249999999999999740000", "97982204999999", "97982204999999.89"},
				[]string{"0.000004829343283", "249999999999999740000", "1207335820749998", "1207335820749998.8"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000006834871106", "249999999999999740000", "1708717776499998", "1708717776499998.2"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000008686667517", "249999999999999740000", "2171666879249998", "2171666879249998"},
				[]string{"0.000011066162127", "249999999999999740000", "2766540531749997", "2766540531749997"},
				[]string{"0.00000039192882", "249999999999999740000", "97982204999999", "97982204999999.89"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004558056201", "249999999999999740000", "1139514050249999", "1139514050249999"},
				[]string{"0.000005388547951", "249999999999999740000", "1347136987749998", "1347136987749998.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000009495590539", "249999999999999740000", "2373897634749997", "2373897634749997.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005186272033", "249999999999999740000", "1296568008249998", "1296568008249998.8"},
				[]string{"0.000006990370298", "249999999999999740000", "1747592574499998", "1747592574499998"},
				[]string{"0.000006873785508", "249999999999999740000", "1718446376999998", "1718446376999998"},
				[]string{"0.00000039192882", "249999999999999740000", "97982204999999", "97982204999999.89"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004504850433", "249999999999999740000", "1126212608249998", "1126212608249998.8"},
				[]string{"0.000005530483313", "249999999999999740000", "1382620828249998", "1382620828249998.5"},
				[]string{"0.000007310119829", "249999999999999740000", "1827529957249998", "1827529957249998.2"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011067991499", "249999999999999740000", "2766997874749997", "2766997874749997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000014234345856", "249999999999999740000", "3558586463999996", "3558586463999996.5"},
				[]string{"0.000000592557184", "249999999999999740000", "148139295999999", "148139295999999.84"},
				[]string{"0.000004913446869", "249999999999999740000", "1228361717249998", "1228361717249998.8"},
				[]string{"0.000004480086345", "249999999999999740000", "1120021586249998", "1120021586249998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000000000303352", "249999999999999740000", "75837999999", "75837999999.99992"},
				[]string{"0.000011252704148", "249999999999999740000", "2813176036999997", "2813176036999997"},
				[]string{"0.000004505674706", "249999999999999740000", "1126418676499999", "1126418676499999"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004675810515", "249999999999999740000", "1168952628749998", "1168952628749998.8"},
				[]string{"0.00000514400844", "249999999999999740000", "1286002109999998", "1286002109999998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004426765887", "249999999999999740000", "1106691471749998", "1106691471749998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011068588146", "249999999999999740000", "2767147036499997", "2767147036499997"},
				[]string{"0.00001106757791", "249999999999999740000", "2766894477499997", "2766894477499997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004884842405", "249999999999999740000", "1221210601249998", "1221210601249998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005899779334", "249999999999999740000", "1474944833499998", "1474944833499998.2"},
				[]string{"0.000013422003779", "249999999999999740000", "3355500944749996", "3355500944749996.5"},
				[]string{"0.000144171486789", "249999999999999740000", "36042871697249960", "36042871697249960"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000000415444549", "249999999999999740000", "103861137249999", "103861137249999.89"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000031928323627", "249999999999999740000", "7982080906749991", "7982080906749991"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.00000002640117", "249999999999999740000", "6600292499999", "6600292499999.993"},
				[]string{"0.000000633269907", "249999999999999740000", "158317476749999", "158317476749999.84"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005064523288", "249999999999999740000", "1266130821999998", "1266130821999998.8"},
				[]string{"0.000004349845721", "249999999999999740000", "1087461430249999", "1087461430249999"},
				[]string{"0.000007703579531", "249999999999999740000", "1925894882749998", "1925894882749998.2"},
				[]string{"0.000000437957083", "249999999999999740000", "109489270749999", "109489270749999.89"},
				[]string{"0.000012046208995", "249999999999999740000", "3011552248749997", "3011552248749997"},
				[]string{"0.00000000002121", "249999999999999740000", "5302499999", "5302499999.999994"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005181989907", "249999999999999740000", "1295497476749998", "1295497476749998.5"},
				[]string{"0.000006057031037", "249999999999999740000", "1514257759249998", "1514257759249998.2"},
				[]string{"0.000007893648991", "249999999999999740000", "1973412247749997", "1973412247749997.8"},
				[]string{"0.00001044882236", "249999999999999740000", "2612205589999997", "2612205589999997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004861240598", "249999999999999740000", "1215310149499998", "1215310149499998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004351580082", "249999999999999740000", "1087895020499999", "1087895020499999"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000000588314769", "249999999999999740000", "147078692249999", "147078692249999.84"},
				[]string{"0.000009859499524", "249999999999999740000", "2464874880999997", "2464874880999997.5"},
				[]string{"0.000004667920393", "249999999999999740000", "1166980098249999", "1166980098249999"},
				[]string{"0.000002939466155", "249999999999999740000", "734866538749999", "734866538749999.2"},
				[]string{"0.00000865481742", "249999999999999740000", "2163704354999997", "2163704354999997.8"},
				[]string{"0.000005125798369", "249999999999999740000", "1281449592249998", "1281449592249998.5"},
				[]string{"0.000004793636505", "249999999999999740000", "1198409126249998", "1198409126249998.8"},
				[]string{"0.000011068483594", "249999999999999740000", "2767120898499997", "2767120898499997"},
				[]string{"0.000007836352763", "249999999999999740000", "1959088190749998", "1959088190749998"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.0000046838042", "249999999999999740000", "1170951049999998", "1170951049999998.8"},
				[]string{"0.000004618700167", "249999999999999740000", "1154675041749998", "1154675041749998.8"},
				[]string{"0.000004537539334", "249999999999999740000", "1134384833499998", "1134384833499998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004776404037", "249999999999999740000", "1194101009249998", "1194101009249998.8"},
				[]string{"0.000005553719601", "249999999999999740000", "1388429900249998", "1388429900249998.5"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000004489784075", "249999999999999740000", "1122446018749998", "1122446018749998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.00000692740917", "249999999999999740000", "1731852292499998", "1731852292499998.2"},
				[]string{"0.000005584462421", "249999999999999740000", "1396115605249998", "1396115605249998.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004327021569", "249999999999999740000", "1081755392249998", "1081755392249998.9"},
				[]string{"0.000004460682023", "249999999999999740000", "1115170505749998", "1115170505749998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000007523930305", "249999999999999740000", "1880982576249998", "1880982576249998"},
				[]string{"0.000005014929065", "249999999999999740000", "1253732266249998", "1253732266249998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000000470315651", "249999999999999740000", "117578912749999", "117578912749999.88"},
				[]string{"0.000011067266143", "249999999999999740000", "2766816535749997", "2766816535749997"},
				[]string{"0.000004606871138", "249999999999999740000", "1151717784499998", "1151717784499998.8"},
				[]string{"0.00000429376189", "249999999999999740000", "1073440472499998", "1073440472499998.9"},
				[]string{"0.000007368882709", "249999999999999740000", "1842220677249998", "1842220677249998"},
				[]string{"0.000005777164954", "249999999999999740000", "1444291238499998", "1444291238499998.5"},
				[]string{"0.000000743682751", "249999999999999740000", "185920687749999", "185920687749999.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011066956193", "249999999999999740000", "2766739048249997", "2766739048249997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004444509005", "249999999999999740000", "1111127251249998", "1111127251249998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000009980851029", "249999999999999740000", "2495212757249997", "2495212757249997.5"},
				[]string{"0.000004438132916", "249999999999999740000", "1109533228999998", "1109533228999998.9"},
				[]string{"0.000004818112356", "249999999999999740000", "1204528088999998", "1204528088999998.8"},
				[]string{"0.000011068963995", "249999999999999740000", "2767240998749997", "2767240998749997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000108090806087", "249999999999999740000", "27022701521749972", "27022701521749972"},
				[]string{"0.000004534886824", "249999999999999740000", "1133721705999998", "1133721705999998.8"},
				[]string{"0.000011066549479", "249999999999999740000", "2766637369749997", "2766637369749997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000003447716551", "249999999999999740000", "861929137749999", "861929137749999.1"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000014014908682", "249999999999999740000", "3503727170499996", "3503727170499996"},
				[]string{"0.000004243148758", "249999999999999740000", "1060787189499998", "1060787189499998.9"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000008180999729", "249999999999999740000", "2045249932249997", "2045249932249997.8"},
				[]string{"0.000001929418705", "249999999999999740000", "482354676249999", "482354676249999.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005589443629", "249999999999999740000", "1397360907249998", "1397360907249998.5"},
				[]string{"0.000004701364694", "249999999999999740000", "1175341173499998", "1175341173499998.8"},
				[]string{"0.000011068179353", "249999999999999740000", "2767044838249997", "2767044838249997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005798168821", "249999999999999740000", "1449542205249998", "1449542205249998.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000009286830011", "249999999999999740000", "2321707502749997", "2321707502749997.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000006054124493", "249999999999999740000", "1513531123249998", "1513531123249998.5"},
				[]string{"0.000010961840774", "249999999999999740000", "2740460193499997", "2740460193499997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.00000459735762", "249999999999999740000", "1149339404999998", "1149339404999998.8"},
				[]string{"0.000004607237865", "249999999999999740000", "1151809466249998", "1151809466249998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004999617541", "249999999999999740000", "1249904385249998", "1249904385249998.8"},
				[]string{"0.000004384426544", "249999999999999740000", "1096106635999998", "1096106635999998.8"},
				[]string{"0.000027592021209", "249999999999999740000", "6898005302249993", "6898005302249993"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011065571432", "249999999999999740000", "2766392857999997", "2766392857999997"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000011685473321", "249999999999999740000", "2921368330249997", "2921368330249997"},
				[]string{"0.000005478819232", "249999999999999740000", "1369704807999998", "1369704807999998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000020025026258", "249999999999999740000", "5006256564499995", "5006256564499995"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000000438960279", "249999999999999740000", "109740069749999", "109740069749999.89"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005384947768", "249999999999999740000", "1346236941999998", "1346236941999998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004414406953", "249999999999999740000", "1103601738249998", "1103601738249998.8"},
				[]string{"0.000010817235452", "249999999999999740000", "2704308862999997", "2704308862999997.5"},
				[]string{"0.000003459054342", "249999999999999740000", "864763585499999", "864763585499999"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000006305221592", "249999999999999740000", "1576305397999998", "1576305397999998.2"},
				[]string{"0.000000589197102", "249999999999999740000", "147299275499999", "147299275499999.84"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000005284741798", "249999999999999740000", "1321185449499998", "1321185449499998.5"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004977496023", "249999999999999740000", "1244374005749998", "1244374005749998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000003919288207", "249999999999999740000", "979822051749999", "979822051749999"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000008701617124", "249999999999999740000", "2175404280999997", "2175404280999997.8"},
				[]string{"0.000009297049021", "249999999999999740000", "2324262255249997", "2324262255249997.5"},
				[]string{"0.00000435040991", "249999999999999740000", "1087602477499998", "1087602477499998.8"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004905866207", "249999999999999740000", "1226466551749998", "1226466551749998.8"},
				[]string{"0.000011188276426", "249999999999999740000", "2797069106499997", "2797069106499997"},
				[]string{"0.000004489846462", "249999999999999740000", "1122461615499998", "1122461615499998.9"},
				[]string{"0.000004626953867", "249999999999999740000", "1156738466749999", "1156738466749999"},
				[]string{"0.000023680418961", "249999999999999740000", "5920104740249994", "5920104740249994"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000004311217028", "249999999999999740000", "1077804256999998", "1077804256999998.9"},
				[]string{"0.000000054417993", "249999999999999740000", "13604498249999", "13604498249999.986"},
				[]string{"0.000005470503287", "249999999999999740000", "1367625821749998", "1367625821749998.5"},
			}

			for i, value := range values {
				stakerProportion := value[0]
				tokensPerDayDecimal := value[1]
				expectedValue := value[2]
				result, err := CalculatePostNileStakerTokenRewards(stakerProportion, tokensPerDayDecimal)
				assert.Nil(t, err)

				assert.Equal(t, expectedValue, result, fmt.Sprintf("row %d: '%s' - '%s' - '%s'", i, stakerProportion, tokensPerDayDecimal, expectedValue))
			}
		})
	})

	t.Run("Operator tokens", func(t *testing.T) {
		t.Run("Should calculate operator amazon fork tokens correctly", func(t *testing.T) {
			for _, value := range operatorAmazonTokens {
				totalStakerOperatorPayout := value[0]
				expectedValue := value[1]

				result, err := CalculateAmazonOperatorTokens(totalStakerOperatorPayout)
				assert.Nil(t, err)
				assert.Equal(t, expectedValue, result)
			}
		})
		t.Run("Should calculate nile fork tokens correctly", func(t *testing.T) {
			for _, value := range operatorNileTokens {
				totalStakerOperatorPayout := value[0]
				expectedValue := value[1]

				result, err := CalculateNileOperatorTokens(totalStakerOperatorPayout)
				assert.Nil(t, err)
				assert.Equal(t, expectedValue, result)
			}
		})
	})
	t.Run("Should use the C implementation of big_gt", func(t *testing.T) {
		t.Run("A should be greater than B", func(t *testing.T) {
			a := "10"
			b := "5"

			result, err := BigGt(a, b)
			assert.Nil(t, err)
			assert.True(t, result)
		})
		t.Run("A should be less than B", func(t *testing.T) {
			a := "5"
			b := "10"

			result, err := BigGt(a, b)
			assert.Nil(t, err)
			assert.False(t, result)
		})

	})
}
